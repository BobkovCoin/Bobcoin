"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.run = void 0;
const parseConfig_1 = require("./config/parseConfig");
const build_1 = require("./pipeline/build");
const createVirtualFileSystem_1 = require("./vfs/createVirtualFileSystem");
async function run(args) {
    // Verify config
    const config = (0, parseConfig_1.verifyConfig)(args.config);
    // Create project's writable fs
    const project = (0, createVirtualFileSystem_1.createVirtualFileSystem)('/', args.files, false);
    // Create stdlib path
    const stdlib = '@stdlib';
    // Compile
    let success = true;
    for (const p of config.projects) {
        const built = await (0, build_1.build)({ config: p, project, stdlib, logger: args.logger });
        success = success && built;
    }
    return success;
}
exports.run = run;
